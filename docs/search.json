[{"path":"https://lnalborczyk.github.io/neurogam/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 neurogam authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ladislas Nalborczyk. Author, maintainer. Paul Bürkner. Contributor.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Nalborczyk L, Bürkner P (2025). “Precise temporal localisation M/EEG effects Bayesian generalised additive multilevel models.” bioRxiv. doi:10.1101/2025.08.29.672336.","code":"@Article{,   title = {Precise temporal localisation of M/EEG effects with Bayesian generalised additive multilevel models},   author = {Ladislas Nalborczyk and Paul Bürkner},   year = {2025},   journal = {bioRxiv},   doi = {10.1101/2025.08.29.672336}, }"},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"modelling-time-resolved-electrophysiological-data-with-bayesian-generalised-additive-multilevel-models-","dir":"","previous_headings":"","what":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"goal neurogam provide utilities estimating onset offset time-resolved effects, found M/EEG, pupillometry, finger/mouse-tracking data (amongst others). current version allows fitting 1D temporal data (e.g., raw M/EEG data decoding timecourses) extended near future support 2D temporal spatiotemporal data.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"can install development version neurogam GitHub :","code":"install.packages(\"remotes\")  remotes::install_github(     repo = \"https://github.com/lnalborczyk/neurogam\",     dependencies = TRUE     )"},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"model-fitting","dir":"","previous_headings":"Usage","what":"Model fitting","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"fit Bayesian generalised additive multilevel model (BGAMM) estimate onset offset difference conditions (simulated EEG data). Note recommend fitting BGAMM time-resolved summary statistics (mean SD) full (.e., trial--trial) BGAMM may slow, group-level BGAM (.e., random/varying effect) may provide liberal cluster estimates.","code":"# loading the neurogam package library(neurogam)  # importing some simulated EEG data data(eeg_data)  # displaying some rows head(eeg_data) #>      participant condition trial  time       eeg #> 1 participant_01     cond1     1 0.000 0.8618045 #> 2 participant_01     cond1     1 0.002 1.2729148 #> 3 participant_01     cond1     1 0.004 1.6538158 #> 4 participant_01     cond1     1 0.006 1.3910888 #> 5 participant_01     cond1     1 0.008 0.6499553 #> 6 participant_01     cond1     1 0.010 0.1548358 # fitting the BGAMM to identify clusters results <- testing_through_time(     # simulated EEG data     data = eeg_data,     # name of predictor in data     # predictor_id = \"condition\",     # when predictor_id = NA, tests average level against 0     predictor_id = NA,     # we recommend fitting the GAMM with summary statistics (mean and SD)     multilevel = \"summary\",     # threshold on posterior odds     threshold = 10     )"},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"visualising-the-results","dir":"","previous_headings":"Usage","what":"Visualising the results","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"","code":"# displaying the identified clusters print(results) #>  #> ==== Time-resolved Bayesian GAMM Results ====================== #>  #> Clusters found: 1 #>  #>  cluster_id cluster_onset cluster_offset duration #>           1         0.162          0.348    0.186 #>  #> ================================================================= # plotting the data, model's predictions, and clusters plot(results)"},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"posterior-predictive-checks","dir":"","previous_headings":"Usage","what":"Posterior predictive checks","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"","code":"# posterior predictive checks (PPCs) ppc(results)"},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"how-to-define-the-basis-dimension","dir":"","previous_headings":"Usage","what":"How to define the basis dimension?","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"","code":"# recommend an optimal smooth basis dimension k k_res <- recommend_k(     object = results,     k_min = 10,     k_max = 40,     k_step = 5,     criterion = \"waic\"     ) # results summary summary(k_res) #>  #> ==== Summary of k recommendation ================================ #>  #> Number of models fitted  : 7 #> k values tested          : 10, 15, 20, 25, 30, 35, 40 #> Range of k values        : [10, 40] #> Knee based on            : p_waic #> Recommended k (knee)     : 20 #>  #> Comparison table (rounded): #>  #>   k   model waic_elpd waic_elpd_se p_waic p_waic_se     waic p_waic_smooth #>  10 gam_k10 -4702.794        5.396  0.115     0.002 9405.588         0.115 #>  15 gam_k15 -4703.034        5.397  0.123     0.002 9406.069         0.123 #>  25 gam_k25 -4703.096        5.396  0.124     0.002 9406.192         0.124 #>  20 gam_k20 -4703.175        5.397  0.125     0.002 9406.349         0.125 #>  30 gam_k30 -4703.233        5.397  0.127     0.002 9406.466         0.127 #>  40 gam_k40 -4703.323        5.397  0.130     0.003 9406.646         0.130 #>  35 gam_k35 -4703.325        5.397  0.130     0.003 9406.650         0.129 #>  #> ================================================================="},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"using neurogam, please cite following publication: Nalborczyk, L., & Bürkner, P. (2025). Precise temporal localisation M/EEG effects Bayesian generalised additive multilevel models. biorXiv. Preprint available : https://doi.org/10.1101/2025.08.29.672336. neurogam interface brms package, please additionally cite one following publications: Bürkner P. C. (2017). brms: R Package Bayesian Multilevel Models using Stan. Journal Statistical Software. 80(1), 1-28. doi.org/10.18637/jss.v080.i01 Bürkner P. C. (2018). Advanced Bayesian Multilevel Modeling R Package brms. R Journal. 10(1), 395-411. doi.org/10.32614/RJ-2018-017 Bürkner P. C. (2021). Bayesian Item Response Modeling R brms Stan. Journal Statistical Software, 100(5), 1-54. doi.org/10.18637/jss.v100.i05","code":""},{"path":"https://lnalborczyk.github.io/neurogam/index.html","id":"getting-help","dir":"","previous_headings":"","what":"Getting help","title":"Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models","text":"encounter bug question please file issue minimal reproducible example GitHub.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/eeg_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated EEG data — eeg_data","title":"Simulated EEG data — eeg_data","text":"Simulated EEG data.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/eeg_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated EEG data — eeg_data","text":"","code":"eeg_data"},{"path":"https://lnalborczyk.github.io/neurogam/reference/eeg_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated EEG data — eeg_data","text":"data frame 502000 rows 5 variables: participant Character variable indicating participant's ID. condition Integer variable indicating condition. trial Integer variable indicating trial number. time Numeric variable indicating time step (seconds). eeg Numeric variable indicating EEG signal.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Find contiguous clusters in a time series — find_clusters","title":"Find contiguous clusters in a time series — find_clusters","text":"Identify contiguous clusters time points time series variable exceeds (falls ) given threshold. Clusters defined consecutive time points thresholding condition holds.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find contiguous clusters in a time series — find_clusters","text":"","code":"find_clusters(data, threshold = 10, above_threshold = TRUE)"},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find contiguous clusters in a time series — find_clusters","text":"data data frame containing least two columns named \"time\" \"value\". Additional columns ignored. threshold Numeric scalar; threshold used define clusters. above_threshold = TRUE, clusters defined value >= threshold. above_threshold = FALSE, clusters defined value <= threshold. above_threshold Logical scalar; TRUE (default), clusters formed value >= threshold. FALSE, clusters formed value <= threshold.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find contiguous clusters in a time series — find_clusters","text":"data frame one row per detected cluster columns: cluster_id: integer cluster index (starting 1); cluster_onset: time first point cluster; cluster_offset: time last point cluster; n_points: number time points cluster. clusters found, empty data frame columns   returned.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find contiguous clusters in a time series — find_clusters","text":"function assumes time variable numeric consecutive rows correspond consecutive time points. Internally, data first arranged time rows NA time value removed.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Find contiguous clusters in a time series — find_clusters","text":"Ladislas Nalborczyk ladislas.nalborczyk@cnrs.fr","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/find_clusters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find contiguous clusters in a time series — find_clusters","text":"","code":"if (FALSE) { # \\dontrun{ set.seed(666) df <- data.frame(   time  = seq(0, 1, length.out = 100),   value = c(rnorm(40, 0, 1), rnorm(20, 5, 1), rnorm(40, 0, 1))   )  # find clusters where value >= 3 cl <- find_clusters(data = df, threshold = 3, above_threshold = TRUE) cl } # }"},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior predictive checks for time-resolved BGAMMs — ppc","title":"Posterior predictive checks for time-resolved BGAMMs — ppc","text":"Generates posterior predictive checks (PPCs) brms model stored inside \"clusters_results\" object, displaying: PPC predicted outcome distribution (densities), PPC summary statistics (mean standard deviation).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior predictive checks for time-resolved BGAMMs — ppc","text":"","code":"ppc(   object,   ndraws_time = 100,   ndraws_stat = 100,   stat = c(\"mean\", \"sd\"),   group_var = NULL,   ... )"},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior predictive checks for time-resolved BGAMMs — ppc","text":"object object class \"clusters_results\" returned testing_through_time. object must contain fitted brms model $model slot. ndraws_time Integer; number posterior draws used distribution-level PPC (density overlay). Defaults 100. ndraws_stat Integer; number posterior draws used statistic-level PPC (mean/SD). Defaults 500. stat character vector summary statistics use \"stat_2d\" PPC. Passed pp_check stat argument. Defaults c(\"mean\", \"sd\"). group_var Optional character scalar specifying name grouping variable grouped PPC. NULL (default), function automatically uses \"predictor\" column exists model data exactly two levels (binary predictor). grouping variable used, density PPC employs type = \"dens_overlay_grouped\"; otherwise, type = \"dens_overlay\". ... Currently ignored. Included future extensibility.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior predictive checks for time-resolved BGAMMs — ppc","text":"patchwork / ggplot2 object containing combined   posterior predictive checks. plot also printed side effect.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior predictive checks for time-resolved BGAMMs — ppc","text":"function convenience wrapper around pp_check patchwork. first tries detect whether model contains binary grouping variable (default, column named \"predictor\" model$data). variable found (group_var explicitly provided), distribution-level PPC produced using type = \"dens_overlay_grouped\", compares predicted observed densities within group. Otherwise, standard type = \"dens_overlay\" PPC drawn. second panel uses type = \"stat_2d\" supplied stat argument (default, mean standard deviation), allowing inspection well posterior predictive distribution reproduces key summary statistics data. two PPC plots combined side--side using wrap_plots, resulting combined plot returned (can modified using standard ggplot2 patchwork operations).","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior predictive checks for time-resolved BGAMMs — ppc","text":"","code":"if (FALSE) { # \\dontrun{ # import some simulated EEG data data(eeg_data) head(eeg_data)  # fit time-resolved model (one-sample test) res <- testing_through_time(   data = eeg_data,   participant_id = \"participant\",   outcome_id = \"eeg\",   time_id = \"time\",   predictor_id = NA,   kvalue = 10,   multilevel = \"summary\"   )  # posterior predictive checks (combined plot) ppc(res) } # }"},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc_clusters_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","title":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","text":"Generates posterior predictive checks (PPCs) brms model stored inside \"clusters_results\" object, displaying: PPC predicted outcome distribution (densities), PPC summary statistics (mean standard deviation).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc_clusters_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","text":"","code":"ppc_clusters_results(   object,   ndraws_time = 100,   ndraws_stat = 100,   stat = c(\"mean\", \"sd\"),   group_var = NULL,   ... )"},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc_clusters_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","text":"object object class \"clusters_results\" returned testing_through_time. object must contain fitted brms model $model slot. ndraws_time Integer; number posterior draws used distribution-level PPC (density overlay). Defaults 100. ndraws_stat Integer; number posterior draws used statistic-level PPC (mean/SD). Defaults 500. stat character vector summary statistics use \"stat_2d\" PPC. Passed pp_check stat argument. Defaults c(\"mean\", \"sd\"). group_var Optional character scalar specifying name grouping variable grouped PPC. NULL (default), function automatically uses \"predictor\" column exists model data exactly two levels (binary predictor). grouping variable used, density PPC employs type = \"dens_overlay_grouped\"; otherwise, type = \"dens_overlay\". ... Currently ignored. Included future extensibility.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc_clusters_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","text":"patchwork / ggplot2 object containing combined   posterior predictive checks. plot also printed side effect.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc_clusters_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","text":"function convenience wrapper around pp_check patchwork. first tries detect whether model contains binary grouping variable (default, column named \"predictor\" model$data). variable found (group_var explicitly provided), distribution-level PPC produced using type = \"dens_overlay_grouped\", compares predicted observed densities within group. Otherwise, standard type = \"dens_overlay\" PPC drawn. second panel uses type = \"stat_2d\" supplied stat argument (default, mean standard deviation), allowing inspection well posterior predictive distribution reproduces key summary statistics data. two PPC plots combined side--side using wrap_plots, resulting combined plot returned (can modified using standard ggplot2 patchwork operations).","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/reference/ppc_clusters_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior predictive checks for time-resolved BGAMMs — ppc_clusters_results","text":"","code":"if (FALSE) { # \\dontrun{ # import some simulated EEG data data(eeg_data) head(eeg_data)  # fit time-resolved model (one-sample test) res <- testing_through_time(   data = eeg_data,   participant_id = \"participant\",   outcome_id = \"eeg\",   time_id = \"time\",   predictor_id = NA,   kvalue = 20,   multilevel = \"summary\"   )  # posterior predictive checks (combined plot) ppc_clusters_results(res) } # }"},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.clusters_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for clusters_results objects — print.clusters_results","title":"Print method for clusters_results objects — print.clusters_results","text":"method provides concise console representation output testing_through_time, including number detected clusters compact table summarising cluster's onset, offset, duration. Values rounded readability.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.clusters_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for clusters_results objects — print.clusters_results","text":"","code":"# S3 method for class 'clusters_results' print(x, digits = 3, ...)"},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.clusters_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for clusters_results objects — print.clusters_results","text":"x object class \"clusters_results\" returned testing_through_time. digits Integer; number decimal places used printing numeric values (default: 3). ... Additional arguments (currently ignored).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.clusters_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for clusters_results objects — print.clusters_results","text":"input object x, returned invisibly.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.clusters_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print method for clusters_results objects — print.clusters_results","text":"printed cluster table includes: cluster_id: numeric identifier cluster; cluster_onset: estimated temporal onset cluster; cluster_offset: estimated temporal offset cluster; duration: duration cluster, computed     cluster_offset - cluster_onset. clusters exceed posterior odds threshold, informative message displayed table printed.","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.recommend_k_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for recommend_k_results objects — print.recommend_k_results","title":"Print method for recommend_k_results objects — print.recommend_k_results","text":"Pretty printer objects class \"recommend_k_results\" returned k-recommendation procedure (e.g., based effective number parameters p_loo p_waic).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.recommend_k_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for recommend_k_results objects — print.recommend_k_results","text":"","code":"# S3 method for class 'recommend_k_results' print(x, digits = 3, ...)"},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.recommend_k_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for recommend_k_results objects — print.recommend_k_results","text":"x object class \"recommend_k_results\". digits Integer; number digits display numeric summaries. ... arguments passed methods (currently ignored).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/print.recommend_k_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for recommend_k_results objects — print.recommend_k_results","text":"input object x, invisibly.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":null,"dir":"Reference","previous_headings":"","what":"Recommend a smooth basis dimension k via effective complexity ","title":"Recommend a smooth basis dimension k via effective complexity ","text":"function takes \"clusters_results\" object produced testing_through_time, refits underlying brms model grid k values, computes model comparison criteria (loo, waic), identifies recommended smooth basis dimension via automatic \"knee\" detection procedure effective number parameters (either p_loo p_waic).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recommend a smooth basis dimension k via effective complexity ","text":"","code":"recommend_k(   object,   k_min = 10,   k_max = 40,   k_step = 5,   criterion = c(\"waic\", \"loo\"),   knee_method = c(\"geometric_smooth\", \"geometric\"),   loess_span = 0.75,   verbose = TRUE )"},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recommend a smooth basis dimension k via effective complexity ","text":"object object class \"clusters_results\" returned testing_through_time. object must contain fitted brms model $model slot. k_min Numeric; minimum value smooth basis dimension k consider. k_max Numeric; maximum value smooth basis dimension k consider. k_step Numeric; step size successive k values. sequence tested values seq(k_min, k_max, = k_step). criterion Character vector model comparison criteria add via add_criterion. Defaults c(\"waic\", \"loo\"). knee_method Character; method knee detection. One : \"geometric\": standard geometric elbow raw         p_* values; \"geometric_smooth\": geometric elbow loess-smoothed         curve p_* vs k, weights         1 / SE(p_*)^2 available (recommended         p_* estimates noisy). loess_span Numeric; smoothing parameter passed loess knee_method = \"geometric_smooth\". Defaults 0.75. verbose Logical; TRUE (default), prints progress messages refitting models different k values.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recommend a smooth basis dimension k via effective complexity ","text":"object class \"recommend_k_results\", list   elements: models: named list refitted brmsfit objects,       one per k value; comparison: data frame summarising model criteria       k (one row per k), including p_* SE; k_values: numeric vector k values       evaluated; recommended_k: k value identified knee       based chosen effective complexity measure method; plot: ggplot2 object displaying p_*       function k error bars knee highlighted; knee_on: complexity measure used (\"p_loo\"       \"p_waic\"); knee_method: knee detection method used.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Recommend a smooth basis dimension k via effective complexity ","text":"k seq(k_min, k_max, = k_step), function: updates s(..., k = ...) terms original brms     formula use new value k, refits model via     update(); calls add_criterion compute requested     criteria, extracts p_loo p_waic standard     errors (available); builds comparison table criteria values across k. recommend basis dimension, function treats chosen complexity measure (p_loo p_waic) function k uses elbow (knee) method: knee_method = \"geometric\" applies geometric knee         procedure directly p_* vs k; knee_method = \"geometric_smooth\" first fits loess curve         p_* ~ k (weights 1 / SE(p_*)^2 available),         applies geometric knee smoothed curve.         reduces influence noisy p_* estimates. resulting plot shows p_* vs k : points line raw p_* estimates; vertical error bars ± SE(p_*) (SEs available); (optionally) dashed line smoothed p_* curve; vertical dashed line recommended k (knee).","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Recommend a smooth basis dimension k via effective complexity ","text":"Ladislas Nalborczyk ladislas.nalborczyk@cnrs.fr.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/recommend_k.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Recommend a smooth basis dimension k via effective complexity ","text":"","code":"if (FALSE) { # \\dontrun{ # import some simulated EEG data data(eeg_data) head(eeg_data)  # fit a time-resolved GAMM res <- testing_through_time(   data = eeg_data,   participant_id = \"participant\",   outcome_id = \"eeg\",   time_id = \"time\",   predictor_id = NA,   kvalue = 20,   multilevel = \"summary\"   )  # recommend an optimal smooth basis dimension k k_res <- recommend_k(   object = res,   k_min = 10,   k_max = 40,   k_step = 5,   criterion = \"waic\"   )  # print summary in the console summary(k_res)  # extract the recommended k value k_res$recommended_k  # access the comparison table k_res$comparison  # visualise effective complexity vs. k k_res$plot } # }"},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.clusters_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for clusters_results objects — summary.clusters_results","title":"Summary method for clusters_results objects — summary.clusters_results","text":"Produces detailed textual summary time-resolved Bayesian GAMM analysis, including model metadata, number clusters detected, descriptive statistics cluster durations. rounded cluster table also printed.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.clusters_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for clusters_results objects — summary.clusters_results","text":"","code":"# S3 method for class 'clusters_results' summary(object, digits = 3, ...)"},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.clusters_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for clusters_results objects — summary.clusters_results","text":"object object class \"clusters_results\" created testing_through_time. digits Integer; number decimal places used printing numeric values (default: 3). ... Additional arguments (currently ignored).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.clusters_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for clusters_results objects — summary.clusters_results","text":"object object, returned invisibly.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.clusters_results.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summary method for clusters_results objects — summary.clusters_results","text":"summary prints: model type used (\"full\", \"summary\",     \"group\"); class underlying brms model number     posterior draws; number clusters detected posterior odds threshold; descriptive statistics cluster durations (minimum, maximum,     mean, median, total duration); neatly formatted table listing cluster's onset, offset,     duration. clusters detected, function prints message returns invisibly.","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.recommend_k_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for recommend_k_results objects — summary.recommend_k_results","title":"Summary method for recommend_k_results objects — summary.recommend_k_results","text":"Provides concise summary k-tuning results, including range tested k values, effective complexity measures (e.g., p_loo p_waic), recommended k obtained via knee detection.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.recommend_k_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for recommend_k_results objects — summary.recommend_k_results","text":"","code":"# S3 method for class 'recommend_k_results' summary(object, digits = 3, ...)"},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.recommend_k_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summary method for recommend_k_results objects — summary.recommend_k_results","text":"object object class \"recommend_k_results\". digits Integer; number digits display numeric summaries. ... arguments passed methods (currently ignored).","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/summary.recommend_k_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summary method for recommend_k_results objects — summary.recommend_k_results","text":"input object object, invisibly.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Time-resolved testing based on BGAMMs — testing_through_time","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"Fits time-resolved Bayesian generalised additive (multilevel) models (BGAMMs) using brms, computes posterior odds effect time point. effect can either ) deviation outcome reference value (e.g., zero chance level), ii) difference two groups/conditions.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"","code":"testing_through_time(   data,   participant_id = \"participant\",   outcome_id = \"eeg\",   time_id = \"time\",   predictor_id = \"condition\",   family = gaussian(),   kvalue = 20,   bs = \"tp\",   multilevel = c(\"summary\", \"full\", \"group\"),   warmup = 1000,   iter = 2000,   chains = 4,   cores = 4,   backend = \"cmdstanr\",   threshold = 10,   n_post_samples = NULL,   chance_level = 0,   sesoi = 0,   credible_interval = 0.95 )"},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"data data frame long format containing time-resolved data. participant_id Character; name column data specifying participant IDs. outcome_id Character; name column data containing outcome values (e.g., M/EEG amplitude, decoding accuracy). time_id Character; name column data containing time information (e.g., seconds samples). predictor_id Character; name column data containing either: binary categorical predictor (e.g., group condition),     case function tests, time point, whether     difference two levels exceeds     chance_level + sesoi; continuous numeric predictor, case function     tests, time point, whether slope outcome     respect predictor differs chance_level + sesoi     (typically chance_level = 0). predictor_id = NA, function tests whether outcome differs     chance_level + sesoi time (useful decoding accuracies,     instance). family brms family object describing response distribution used model (defaults gaussian()). kvalue Numeric; basis dimension k passed smooth term s(time, ..., k = kvalue). bs Character; Character scalar; type spline basis used brms (passed s(), e.g., \"tp\" thin-plate splines). multilevel Character; model fit. One \"full\": Full GAMM participant-level random/varying effects; \"summary\": GAMM fitted participant-level summary     statistics (mean outcome standard deviation); \"group\": Group-level GAM fitted participant-averaged     data (random/varying effects). warmup Numeric; number warm-iterations per chain. iter Numeric; total number iterations per chain (including warmup). chains Numeric; number MCMCs. cores Numeric; number parallel cores use. backend Character; package use backend fitting Stan model. One \"cmdstanr\" (default) \"rstan\". threshold Numeric; threshold posterior odds (prob_ratio) used define contiguous temporal clusters. Values greater 1 favour hypothesis effect exceeds chance_level + sesoi. n_post_samples Numeric; number posterior draws used compute posterior probabilities. NULL (default), available draws fitted model used. chance_level Numeric; reference value outcome (e.g., 0.5 decoding accuracy). used testing constant (.e., predictor_id effect difference chance). sesoi Numeric; smallest effect size interest (SESOI). posterior probability computed effect strictly larger chance_level + sesoi. credible_interval Numeric; width credible (quantile) interval.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"object class \"clusters_results\", list   elements: clusters: data frame one row per detected cluster       (e.g., cluster_onset, cluster_offset, duration); predictions: data frame time-resolved posterior       summaries (posterior median, credible interval, posterior       probabilities, odds prob_ratio); data: data used fit brms model       (possibly summarised); model: fitted brms model object; multilevel: value multilevel argument. object associated plot() method visualising   smoothed time course detected clusters, well print()   summary() methods.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"Internally, function: builds formula smooth term time (optionally group); fits brms model according multilevel; uses tidybayes extract posterior predictions time; computes, time point, posterior probability     effect (condition difference) exceeds chance_level + sesoi; converts posterior odds (prob_ratio) applies     clustering procedure (find_clusters()) time.","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"Ladislas Nalborczyk ladislas.nalborczyk@cnrs.fr.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/reference/testing_through_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Time-resolved testing based on BGAMMs — testing_through_time","text":"","code":"if (FALSE) { # \\dontrun{ # import some simulated EEG data data(eeg_data) head(eeg_data)  # fit the BGAMM to identify clusters results <- testing_through_time(data = eeg_data)  # display the identified clusters print(results$clusters)  # plot the GAM-smoothed signal and identified clusters plot(results) } # }"},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/news/index.html","id":"new-features-0-0-3","dir":"Changelog","previous_headings":"","what":"New features","title":"neurogam 0.0.3","text":"Implementing recommend_k() function, running model comparison varying basis dimension (k). Implementing ppc() methods cluster_results objects.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/news/index.html","id":"other-changes-0-0-3","dir":"Changelog","previous_headings":"","what":"Other changes","title":"neurogam 0.0.3","text":"Improved documentation print() summary() methods.","code":""},{"path":[]},{"path":"https://lnalborczyk.github.io/neurogam/news/index.html","id":"new-features-0-0-2","dir":"Changelog","previous_headings":"","what":"New features","title":"neurogam 0.0.2","text":"Allowing 3 different models fitted: full GAMM, GAMM summary statistics (recommended), group-level GAM. Adding support presence absence predictor (e.g., group, condition). predictor_id = NA, neurogam now tests signal 0 time. Implementing print() summary() methods cluster_results objects. Improved plotting: now plotting GAM predictions raw data improved clusters aesthetics.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/news/index.html","id":"other-changes-0-0-2","dir":"Changelog","previous_headings":"","what":"Other changes","title":"neurogam 0.0.2","text":"Improved functions documentation new package website. Factoring posterior odds computation within internal functions.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/news/index.html","id":"bug-fixes-0-0-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"neurogam 0.0.2","text":"Fixing group-level posterior predictions multilevel “full” “summary”.","code":""},{"path":"https://lnalborczyk.github.io/neurogam/news/index.html","id":"neurogam-001","dir":"Changelog","previous_headings":"","what":"neurogam 0.0.1","title":"neurogam 0.0.1","text":"Pushing first version neurogam.","code":""}]
