---
output: github_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    cache = TRUE,
    warning = FALSE,
    message = FALSE,
    comment = "#>",
    fig.path = "man/figures/README-",
    out.width = "100%"
    )
```

# Precise temporal localisation of time-resolved effects with Bayesian generalised additive multilevel models

The goal of `neurogam` is to provide utilities for estimating the onset and offset of time-resolved effects, such as those found in M/EEG, pupillometry, or finger/mouse-tracking data (amongst others). The current version only allows fitting 1D temporal data (e.g., raw M/EEG data or decoding timecourses) but will be extended in the near future to support 2D temporal or spatiotemporal data.

## Installation

You can install the development version of `neurogam` from GitHub with:

```{r packages, eval = FALSE}
install.packages("remotes")

remotes::install_github(
    repo = "https://github.com/lnalborczyk/neurogam",
    dependencies = TRUE
    )
```

## Usage

Below we fit a Bayesian generalised additive multilevel model (BGAMM) to estimate the onset and offset of a difference between conditions (in simulated EEG data).

```{r data}
# loading the neurogam package
library(neurogam)

# importing some simulated EEG data
data(eeg_data)

# displaying some rows
head(eeg_data)
```

```{r clusters, results = "hide"}
# fitting the BGAMM to identify clusters
results <- testing_through_time(
    data = eeg_data,
    predictor_id = "condition",
    threshold = 10
    )
```

```{r print-clusters}
# displaying the identified clusters
print(results$clusters)
```

```{r fig-clusters, fig.asp = 0.5, dev = "png", dpi = 200}
# plotting the identified clusters superimposed with the data and GAM-smoothed data
plot(results)
```
