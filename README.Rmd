---
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    cache = TRUE,
    warning = FALSE,
    message = FALSE,
    comment = "#>",
    fig.path = "man/figures/README-",
    out.width = "100%"
    )
```

# Modelling time-resolved electrophysiological data with Bayesian generalised additive multilevel models <a href="https://lnalborczyk.github.io/neurogam/"><img src="man/figures/logo.png" align="right" height="139" alt="neurogam website" /></a>

The goal of `neurogam` is to provide utilities for estimating the onset and offset of time-resolved effects, such as those found in M/EEG, pupillometry, or finger/mouse-tracking data (amongst others). The current version only allows fitting 1D temporal data (e.g., raw M/EEG data or decoding timecourses) but will be extended in the near future to support 2D temporal or spatiotemporal data.

## Installation

You can install the development version of `neurogam` from GitHub with:

```{r packages, eval = FALSE}
install.packages("remotes")

remotes::install_github(
    repo = "https://github.com/lnalborczyk/neurogam",
    dependencies = TRUE
    )
```

## Usage

Below we fit a Bayesian generalised additive multilevel model (BGAMM) to estimate the onset and offset of a difference between conditions (in simulated EEG data).

```{r data}
# loading the neurogam package
library(neurogam)

# importing some simulated EEG data
data(eeg_data)

# displaying some rows
head(eeg_data)
```

```{r clusters, results = "hide"}
# fitting the BGAMM to identify clusters
results <- testing_through_time(
    # simulated EEG data
    data = eeg_data,
    # name of predictor in data
    predictor_id = "condition",
    # we recommend fitting the GAMM with summary statistics (mean and SD)
    multilevel = "summary",
    # threshold on posterior odds
    threshold = 10
    )
```

```{r print-clusters}
# displaying the identified clusters
print(results)
```

```{r fig-clusters, fig.asp = 0.5, dev = "png", dpi = 300}
# plotting the data, model's predictions, and clusters
plot(results)
```

## Citation

Nalborczyk, L., & BÃ¼rkner, P. (2025). Precise temporal localisation of M/EEG effects with Bayesian generalised additive multilevel models. Preprint available at: <https://doi.org/10.1101/2025.08.29.672336>.

## Getting help

If you encounter a bug or have a question please file an issue with a minimal reproducible example on [GitHub](https://github.com/lnalborczyk/neurogam/issues).
